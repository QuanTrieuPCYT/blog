---
layout: post
title: Thay Ä‘á»•i logo khá»Ÿi Ä‘á»™ng trÃªn má»™t chiáº¿c laptop Dell
description: Sau vÃ i ngÃ y vá»c vÃ  tÃ¬m hiá»ƒu, mÃ¬nh Ä‘Ã£ thay Ä‘á»•i thÃ nh cÃ´ng UEFI Boot Logo cá»§a má»™t chiáº¿c laptop Dell. CÃ¹ng xem mÃ¬nh Ä‘Ã£ lÃ m nhÆ° nÃ o nhÃ©.
date: 2024-12-08 22:43:30 +0700
image: /images/result.jpg
---
NhÆ° cÃ¡c báº¡n Ä‘Ã£ biáº¿t (hoáº·c cÃ³ thá»ƒ khÃ´ng), mÃ¬nh lÃ  má»™t Ä‘á»©a khÃ¡ thÃ­ch vá»c váº¡ch máº¥y thá»© liÃªn quan Ä‘áº¿n cÃ´ng nghá»‡ ğŸ¥² vÃ  bÃ i viáº¿t nÃ y sáº½ nÃ³i vá» má»™t trong nhá»¯ng tráº£i nghiá»‡m vá»c váº¡ch vá»«a qua cá»§a mÃ¬nh.

## Má»™t tÃ­ background
Ã”ng anh há» mÃ¬nh cÃ³ nhá» mÃ¬nh cÃ i láº¡i Windows há»™ trÃªn má»™t con mÃ¡y vÃ  Ä‘á»ƒ láº¡i á»Ÿ nhÃ  mÃ¬nh vÃ i ngÃ y. Con lap nÃ y cá»¥ thá»ƒ lÃ  má»™t con Dell Latitude E7240, xÃ i chip Intel Core i7-4600U, vá»›i 4GB RAM DDR3L (hÆ¡i Ã­t Ä‘á»ƒ xÃ i trong 2024 ğŸ’€) vÃ  SSD mPCIe 128GB.

![image.jpg](/images/e7240_next_to_mbp.jpg)\
<sup>Dell Latitude E7240 (pháº£i), Ä‘á»ƒ cáº¡nh MacBook Pro 14-inch cá»§a mÃ¬nh (trÃ¡i)</sup>

Thá»±c sá»±, mÃ¬nh khÃ¡ lÃ  thÃ­ch con laptop nÃ y ğŸ˜. Con máº¯m nÃ y cÃ³ 2 cá»•ng RAM DDR3L, nháº­n max 1600MHz, kÃ¨m vá»›i **táº­n 3 slot mPCIe** cho kháº£ nÄƒng má»Ÿ rá»™ng card Wi-Fi, card WAN, SSD mPCIe vÃ  cÃ³ khi lÃ  cáº£ GPU rá»i! MÃ¡y cÃ²n cÃ³ thÃªm cáº£ khay SIM (Ä‘á»ƒ xÃ i khi mÃ¡y cÃ³ cáº¯m WAN Card) vÃ  cáº£ **detachable dual-storage BIOS module** (chip Ä‘Ã´i BIOS cÃ³ thá»ƒ thÃ¡o rá»i) ná»¯a. MÃ¡y cáº§m khÃ¡ lÃ  nháº¹ vÃ  má»ng, Ä‘á»“ng thá»i cÃ¡c back cover Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ dá»… dÃ ng thÃ¡o rá»i, Ä‘Ãºng lÃ  lap cho máº¥y doanh nhÃ¢n cÃ³ khÃ¡c...!

![image.jpg](/images/detachable_dualstorage_bios.jpg)\
<sup>vá» lá» luÃ´n</sup>

VÃ¬ con lap nÃ y xÃ i khÃ¡ lÃ  thÃ­ch, nÃªn mÃ¬nh cÅ©ng Ä‘Ã£ quyáº¿t Ä‘á»‹nh vá»c váº¡ch vÃ i thá»© trÃªn Ä‘Ã³ luÃ´n. MÃ¬nh cÅ©ng Ä‘Ã£ thá»­ undervolting Ä‘á»ƒ khiáº¿n cho con i7-4600U trong mÃ¡y cháº¡y Ä‘á»¡ nÃ³ng khi max xung nhá»‹p Turbo, vÃ  hÆ¡n cáº£ lÃ  Ä‘Ã£ mod thÃ nh cÃ´ng logo khá»Ÿi Ä‘á»™ng cá»§a mÃ¡y. NhÆ° nÃ o thÃ¬ cÃ¹ng follow mÃ¬nh nhÃ©!

**LÆ°u Ã½:**
- Guide nÃ y chá»‰ Ã¡p dá»¥ng hoÃ n toÃ n cho Dell Latitude E7240 cháº¡y phiÃªn báº£n BIOS A08 (18/02/2014). CÃ¡c mÃ¡y khÃ¡c cÃ³ thá»ƒ Ã¡p dá»¥ng Ä‘Æ°á»£c (kháº£ nÄƒng cao nháº¥t lÃ  cho cÃ¡c mÃ¡y Dell xÃ i AMI BIOS kÃ¨m checksum + Intel Boot Guard), nhÆ°ng mÃ¬nh sáº½ khÃ´ng Ä‘áº£m báº£o 100%.
- Náº¿u update BIOS thÃ¬ sáº½ pháº£i lÃ m láº¡i. Muá»‘n giá»¯ á»•n Ä‘á»‹nh thÃ¬ tá»‘t nháº¥t khÃ´ng update, cÃ³ vÃ i hÃ£ng cÅ©ng push cáº£ UEFI Capsule qua Windows Update luÃ´n, nÃªn cháº¯c cháº¯n ráº±ng UEFI Capsule á»Ÿ trong BIOS Ä‘Æ°á»£c táº¯t Ä‘á»ƒ trÃ¡nh pháº£i má»‡t...!
- MÃ¬nh cÅ©ng khÃ´ng cháº¯c 100% nhá»¯ng thÃ´ng tin á»Ÿ bÃªn dÆ°á»›i lÃ  chuáº©n xÃ¡c. Náº¿u cÃ³ sai sÃ³t thÃ¬ cÃ¡c báº¡n chá»‰ ra giÃºp mÃ¬nh nha!

## Má»¥c tiÃªu
Táº¡i vÃ¬ Ä‘Ã¢y khÃ´ng pháº£i lÃ  con laptop cá»§a mÃ¬nh nÃªn lÃ  mÃ¬nh sáº½ cá»‘ gáº¯ng lÃ m báº£n mod nÃ y mÃ  khÃ´ng pháº£i **thÃ¡o vÃ  program láº¡i BIOS cá»§a mÃ¡y báº±ng cÃ¡c phÆ°Æ¡ng phÃ¡p váº­t lÃ­**.

NhÆ° cÃ¡c báº¡n tháº¥y trÃªn bá»©c áº£nh mÃ¬nh cáº§m cÃ¡i module BIOS cá»§a mÃ¡y, mÃ¡y nÃ y sá»­ dá»¥ng thiáº¿t káº¿ dualstorage BIOS, cÃ³ nghÄ©a lÃ  2 chip sáº½ chá»©a nhá»¯ng phÃ¢n vÃ¹ng khÃ¡c nhau cá»§a firmware mÃ¡y. Viá»‡c tá»± dump hai chip nÃ y ra báº±ng káº¹p náº¡p + CH341A sáº½ khÃ¡ tá»‘n thá»i gian (khÃ´ng nhÆ° nhá»¯ng mÃ¡y chá»‰ xÃ i 1 chip BIOS), viá»‡c há»£p nháº¥t 2 image cá»§a chip nÃ y, mod vÃ  split láº¡i cÅ©ng khÃ¡ tá»‘n thÃ¬ giá» ná»¯a, vÃ  Ä‘Ã¢y cÅ©ng khÃ´ng pháº£i lÃ  laptop mÃ¬nh (ğŸ˜­) nÃªn mÃ¬nh Ä‘Ã£ lá»±a chá»n viá»‡c **flash trá»±c tiáº¿p báº±ng cÃ¡c cÃ´ng cá»¥ cÃ³ sáºµn trÃªn Windows**.

## NÃ´m na lÃ  nhÆ° nÃ y
NÃ³i vá» máº·t chung chung, quÃ¡ trÃ¬nh mod sáº½ khÃ¡ Ä‘Æ¡n giáº£n, cÃ³ thá»ƒ nÃ³i nÃ´m na lÃ  nhÆ° sau:

**Dump file firmware gá»‘c mÃ¡y ra -> Thay file logo cá»§a NSX báº±ng logo cá»§a mÃ¬nh -> Flash láº¡i -> Profit!**

Tuy nhiÃªn thá»±c táº¿, quÃ¡ trÃ¬nh nÃ³ láº¡i khÃ´ng hoÃ n toÃ n Ä‘Æ¡n giáº£n nhÆ° váº­y ğŸ˜‚ cÃ¡c báº¡n cá»© Ä‘á»c tiáº¿p thÃ¬ sáº½ hiá»ƒu.

## Dump firmware gá»‘c cá»§a mÃ¡y (pháº§n 1)
CÃ¡ch Ä‘Æ¡n giáº£n nháº¥t vÃ  cÃ³ láº½ lÃ  tháº³ng tháº¯n nháº¥t sáº½ lÃ  extract trá»±c tiáº¿p tá»« chip qua 1 programmer nhÆ° CH341A. NhÆ°ng nhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, mÃ¬nh sáº½ khÃ´ng lÃ m tháº¿.

ThÃ¬ qua vÃ i phÃºt Google, mÃ¬nh Ä‘Ã£ tÃ¬m hiá»ƒu Ä‘Æ°á»£c ráº±ng Intel ME cÃ³ kháº£ nÄƒng dump chip BIOS, miá»…n lÃ  firmware vÃ  pháº§n cá»©ng khÃ´ng cÃ³ cÃ¡c restrictions do Intel vÃ  nhÃ  sáº£n xuáº¥t Ä‘áº·t ra báº±ng cÃ¡ch sá»­ dá»¥ng **Intel Flash Programming Tool**. Flash Programming Tool sáº½ Ä‘i theo suite (CS)ME System Tools cá»§a Intel, vÃ  má»—i má»™t phiÃªn báº£n cá»§a Intel ME sáº½ xÃ i má»™t phiÃªn báº£n System Tools khÃ¡c nhau. MÃ¬nh sáº½ Ä‘á»ƒ link tool nÃ y á»Ÿ [**Ä‘Ã¢y**](https://mega.nz/folder/qdVAyDSB#FLCPaDVIsPYiy2TAUjD7RQ).

**LÆ°u Ã½:** HÃ£y cháº¯c cháº¯n ráº±ng driver chipset vÃ  Intel ME cá»§a cÃ¡c báº¡n **Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t cáº©n tháº­n**, náº¿u khÃ´ng nhá»¯ng bÆ°á»›c tá»›i Ä‘Ã¢y sáº½ khÃ´ng thá»±c hiá»‡n Ä‘Æ°á»£c.

Äá»ƒ biáº¿t Ä‘Æ°á»£c mÃ¡y báº¡n Ä‘ang xÃ i phiÃªn báº£n Intel ME gÃ¬, cÃ¡c báº¡n cÃ³ thá»ƒ táº£i [**IntelÂ® Converged Security and Management Engine Version Detection Tool**](https://www.intel.com/content/www/us/en/download/19392/intel-converged-security-and-management-engine-version-detection-tool-intel-csmevdt.html) Ä‘á»ƒ xem.

![image.png](/images/csme_detection_result.png)

NhÆ° cÃ¡c báº¡n cÃ³ thá»ƒ tháº¥y trong áº£nh, mÃ¬nh Ä‘ang xÃ i ME version 9.5 nÃªn sáº½ táº£i ME System Tools 9.5. Sau khi cÃ¡c báº¡n táº£i vá», giáº£i nÃ©n, vÃ o thÆ° má»¥c `Flash Programming Tool\WIN64` (hoáº·c `WIN32` náº¿u báº¡n xÃ i Windows 32-bit, thay Ä‘á»•i `W64` thÃ nh `W32` trong guide náº¿u báº¡n Ä‘á»c tiáº¿p).

Tiáº¿p tá»¥c, má»Ÿ má»™t cá»­a sá»• command line **dÆ°á»›i quyá»n Administrator** vÃ  cháº¡y lá»‡nh `FPTW64.exe -bios -D bios.bin` Ä‘á»ƒ dump **phÃ¢n vÃ¹ng BIOS** cá»§a mÃ¡y vÃ o má»™t file tÃªn `bios.bin`.

![image.png](/images/bios_partition_dump_completed.png)

NhÆ° cÃ¡c báº¡n cÃ³ thá»ƒ tháº¥y, mÃ¬nh Ä‘Ã£ dump Ä‘Æ°á»£c phÃ¢n vÃ¹ng BIOS cá»§a mÃ¡y Ä‘á»ƒ tÃ­ ná»¯a chá»‰nh sá»­a. Tiáº¿p theo, mÃ¬nh thá»­ viáº¿t láº¡i chÃ­nh cÃ¡i dump vÃ o BIOS xem lÃ  cÃ³ viáº¿t Ä‘Æ°á»£c khÃ´ng.

![image.png](/images/write_fail_bios.png)

NhÆ° cÃ¡c báº¡n cÃ³ thá»ƒ tháº¥y... mÃ¬nh khÃ´ng viáº¿t láº¡i Ä‘Æ°á»£c, cÃ³ váº» nhÆ° giá», phÃ¢n vÃ¹ng BIOS Ä‘ang trong tráº¡ng thÃ¡i read-only. ThÃ´i thÃ¬ Ã­t ra chÃºng ta cÅ©ng Ä‘Ã£ cÃ³ backup láº¡i Ä‘Æ°á»£c phÃ¢n vÃ¹ng BIOS... nhá»‰?

Tuy nhiÃªn, Ä‘Ã¢y khÃ´ng pháº£i lÃ  má»™t báº£n backup BIOS hoÃ n chá»‰nh cá»§a mÃ¡y, táº¡i BIOS full nÃ³ bao gá»“m cáº£ phÃ¢n vÃ¹ng Intel ME vÃ  vÃ i cÃ¡i láº·t váº·t ná»¯a. Viá»‡c dump full content cá»§a BIOS khÃ¡ quan trá»ng Ä‘á»ƒ phÃ²ng khi tÃ­ ná»¯a mÃ¡y mÃ¬nh káº»o cÃ³ Äƒn c*t thÃ¬ cÅ©ng cÃ²n cÃ³ Ä‘Æ°á»ng cá»©u...! Äá»ƒ dump full content cá»§a chip BIOS, mÃ¬nh sá»­ dá»¥ng lá»‡nh `FPTW64.exe -D fullbios.bin`.

![image.png](/images/fullbios_dump_error.png)

...tuy nhiÃªn, mÃ¬nh cÅ©ng Ä‘Ã£ dÃ­nh lá»—i, láº§n nÃ y khÃ´ng dump Ä‘Æ°á»£c. Sau Ä‘Ã³ mÃ¬nh ngá»“i Ä‘á»™ng nÃ£o 3 phÃºt vÃ  Ä‘Ã£ nghÄ© ra Ä‘Æ°á»£c nguyÃªn nhÃ¢n. Nháº­p tiáº¿p `FPTW64 -I` Ä‘á»ƒ hiá»‡n háº¿t thÃ´ng tin liÃªn quan Ä‘áº¿n programmer Ä‘á»ƒ tháº¥y rÃµ:

![image.png](/images/flash_info_image.png)

Lá»‡nh dump sáº½ dump toÃ n bá»™ chip nÃªn yÃªu cáº§u toÃ n bá»™ phÃ¢n vÃ¹ng cá»§a BIOS pháº£i cÃ³ **read access**. Tuy nhiÃªn nhÆ° trÃªn áº£nh, cÃ¡c báº¡n cÃ³ thá»ƒ tháº¥y ráº±ng phÃ¢n vÃ¹ng Intel ME khÃ´ng cÃ³ cáº£ read vÃ  write access, khiáº¿n cho quÃ¡ trÃ¬nh Ä‘Ã³ fail. Äiá»u nÃ y chá»©ng tá» ráº±ng Ä‘ang cÃ³ má»™t cÃ¡i khÃ³a gÃ¬ Ä‘Ã³ trong firmware hoáº·c hardware rÃ ng buá»™c quÃ¡ trÃ¬nh nÃ y.

<sup>(Náº¿u cÃ¡c báº¡n muá»‘n tÃ¬m hiá»ƒu thÃªm vá» nhá»¯ng kiá»ƒu "khÃ³a" nÃ y, Ä‘á»c pháº§n [Notes](#notes) á»Ÿ cuá»‘i bÃ i.)</sup>

Váº­y lÃ  giá» ta sáº½ pháº£i tá»± tay mod vÃ  flash má»i thá»© mÃ  pháº£i Ä‘á»™ng tay vÃ o chip sao? NhÆ°ng khÃ´ng, hi vá»ng giá» Ä‘Ã¢y váº«n chÆ°a háº¿t! ThÆ°á»ng thÃ¬ cÃ¡c nhÃ  sáº£n xuáº¥t sáº½ Ä‘á»ƒ má»™t tÃ¹y chá»n áº©n trong BIOS cho phÃ©p táº¯t nhá»¯ng cÃ¡i khÃ³a liÃªn quan Ä‘áº¿n CPU vÃ  firmware, nÃªn tiáº¿p theo mÃ¬nh sáº½ tiáº¿n hÃ nh vá»c vÃ´ cÃ i Ä‘áº·t BIOS cá»§a mÃ¡y, thá»­ xem lÃ  cÃ³ khÃ´ng.

## Vá»c vÃ o cÃ i Ä‘áº·t BIOS cá»§a mÃ¡y
CÃ¡i trang cÃ i Ä‘áº·t BIOS cá»§a cÃ¡c báº¡n khi vÃ o sáº½ cÃ³ má»™t sá»‘ lÆ°á»£ng tÃ¹y chá»n nháº¥t Ä‘á»‹nh. Tuy nhiÃªn, 99% ráº±ng BIOS cá»§a báº¡n sáº½ cÃ³ cÃ¡c tÃ¹y chá»n áº©n khÃ¡c, do nhÃ  sáº£n xuáº¥t muá»‘n giáº¥u chÃºng Ä‘á»ƒ trÃ¡nh ngÆ°á»i dÃ¹ng tÃ¡y mÃ¡y ğŸ˜‚, vÃ  Ä‘á»ƒ biáº¿t Ä‘Æ°á»£c xem cÃ³ nhá»¯ng tÃ¹y chá»n nÃ o thÃ¬ chÃºng ta cáº§n pháº£i extract Ä‘Æ°á»£c IFR tá»« trang Setup cá»§a BIOS.

NÃ³i qua vá» IFR: IFR (**I**nternal **F**orm **R**epresentation) lÃ  1 dáº¡ng binary dÃ¹ng Ä‘á»ƒ chá»©a chá»¯, áº£nh vÃ  má»™t sá»‘ file láº·t váº·t dÃ¹ng Ä‘á»ƒ hiá»‡n lÃªn 1 mÃ n hÃ¬nh config trong 1 BIOS cá»§a má»™t mÃ¡y tÃ­nh.

Äá»ƒ extract Ä‘Æ°á»£c IFR, chÃºng ta cáº§n 2 tool: [**UEFITool**](https://github.com/LongSoft/UEFITool) vÃ  [**Universal-IFR-Extractor**](https://github.com/LongSoft/Universal-IFR-Extractor). CÃ¡i Ä‘áº§u sáº½ dÃ¹ng Ä‘á»ƒ extract IFR tá»« file BIOS cá»§a chÃºng ta vÃ  cÃ¡i tiáº¿p theo dÃ¹ng Ä‘á»ƒ biáº¿n IFR vá» dáº¡ng file text Ä‘á»c Ä‘Æ°á»£c.

Äáº§u tiÃªn, má»Ÿ file BIOS chÃºng ta vá»«a dump Ä‘Æ°á»£c trong UEFITool.

![image.png](/images/uefitool_first_bios_image.png)

Äáº­p vÃ o máº¯t chÃºng ta lÃ  hai thá»© khÃ´ng máº¥y lÃ  vui cho láº¯m ğŸ˜€, cá»¥ thá»ƒ lÃ  firmware cá»§a ta cÃ³ Intel Boot Guard, nÃªn khi mÃ  thay Ä‘á»•i thá»© gÃ¬ trong firmware, **chÃºng ta pháº£i cá»±c kÃ¬ cáº©n tháº­n!**

Báº¡n cá»© hiá»ƒu ráº±ng Intel Boot Guard nÃ³ nhÆ° lÃ  UEFI Secure Boot nhÆ°ng lÃ  cho firmware cá»§a mÃ¡y áº¥y. Má»™t vÃ i pháº§n cá»§a firmware mÃ¡y sáº½ Ä‘Æ°á»£c kiá»ƒm tra lÃºc khá»Ÿi Ä‘á»™ng vÃ  tham chiáº¿u vá»›i má»™t key cÃ³ sáºµn trong **chipset** cá»§a mÃ¡y. Key Ä‘Ã³ sáº½ Ä‘Æ°á»£c nhÃ  sáº£n xuáº¥t **nhÃ©t vÃ o trong chipset** tá»« lÃºc sáº£n xuáº¥t, nÃªn viá»‡c mod sai firmware sáº½ khiáº¿n cho mÃ¡y chÃºng ta **khÃ´ng thá»ƒ khá»Ÿi Ä‘á»™ng**! Tuy nhiÃªn, cÃ¡c nhÃ  phÃ¡t triá»ƒn UEFITool Ä‘Ã£ giÃºp chÃºng ta khÃ¡ nhiá»u á»Ÿ Ä‘Ã¢y. Nhá»¯ng component chá»‹u sá»± tra kháº£o cá»§a Intel Boot Guard Ä‘Ã£ Ä‘Æ°á»£c tÃ´ mÃ u (nhÆ° trÃªn áº£nh), nÃªn chÃºng ta chá»‰ cáº§n trÃ¡nh nhá»¯ng pháº§n Ä‘Ã³ ra lÃ  Ä‘Æ°á»£c. (thank you so much ğŸ™)

Äá»ƒ tÃ¬m IFR cá»§a Setup trong BIOS chÃºng ta, invoke Ã´ tÃ¬m kiáº¿m báº±ng phÃ­m táº¯t Ctrl + F, rá»“i chÃºng ta tÃ¬m theo text theo tÃªn má»™t má»¥c cÃ i Ä‘áº·t mÃ  Ä‘ang hiá»‡n cÃ³ trong cÃ i Ä‘áº·t BIOS cá»§a chÃºng ta. MÃ¬nh sáº½ thá»­ tÃ¬m `Secure Boot`.

![image.png](/images/ifr_find_uefitool.png)

NhÆ° cÃ¡c báº¡n tháº¥y Ä‘áº¥y, mÃ¬nh Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c thÃ nh cÃ´ng Ä‘Æ°á»£c IFR cá»§a Setup BIOS. Tiáº¿p theo, cÃ¡c báº¡n chuá»™t pháº£i, chá»n `Extract as is` Ä‘á»ƒ lÆ°u file ra dÆ°á»›i Ä‘uÃ´i `.sct`.

Tuy nhiÃªn, file nÃ y váº«n lÃ  dáº¡ng binary Ä‘áº·c biá»‡t vÃ  ta sáº½ khÃ´ng tá»± Ä‘á»c Ä‘Æ°á»£c theo láº½ thÃ´ng thÆ°á»ng. Tiáº¿p theo, ta cáº§n sá»­ dá»¥ng Universal-IFR-Extractor Ä‘á»ƒ chuyá»ƒn Ä‘á»•i ra thÃ nh dáº¡ng text.

![image.png](/images/ifrextract.png)

```
ifrextract file.sct setup.txt
```
thay `file.sct` thÃ nh tÃªn file Ä‘uÃ´i `.sct` mÃ  báº¡n vá»«a má»›i extract tá»« UEFITool.

Sau khi má»Ÿ file nÃ y lÃªn, ta tháº¥y Ä‘Æ°á»£c táº¥t cáº£ cÃ¡c tÃ¹y chá»n BIOS cá»§a chÃºng ta. Báº¡n sáº½ cáº£m tháº¥y ráº±ng: "Sao nÃ³ láº¡i nhiá»u tháº¿!?", vÃ¬ nÃ³ tÃ­nh cáº£ cÃ¡c option mÃ  nhÃ  sáº£n xuáº¥t áº©n Ä‘i Ä‘Ã³. Nhiá»u láº¯m pháº£i khÃ´ng ğŸ˜‚â‰ï¸

Sau khi má»Ÿ file, mÃ¬nh dÃ nh vÃ i phÃºt lá»¥c qua cÃ¡c tÃ¹y chá»n vÃ  tÃ¬m Ä‘Æ°á»£c má»™t sá»‘ thá»©:

![image.png](/images/bios_lock_ifr.png)\
![image.png](/images/bios_interface_lock_ifr.png)\
![image.png](/images/me_fw_image_re_flash_ifr.png)\
![image.png](/images/var_store_name.png)\
<sup>ChÃº Ã½ tá»›i `VarOffset` vÃ  `VarStore` nhÃ©, mÃ¬nh sáº½ giáº£i thÃ­ch vá» sau!</sup>

Theo nhÆ° mÃ¬nh tÃ¬m hiá»ƒu qua, `BIOS Lock` vÃ  `BIOS Interface Lock` lÃ  hai khÃ³a trong firmware dÃ¹ng Ä‘á»ƒ cháº·n flash BIOS. `Me Fw Image Re-Flash` dÃ¹ng Ä‘á»ƒ cho phÃ©p Intel ME Ä‘Æ°á»£c Ä‘á»c vÃ  Ä‘Æ°á»£c náº¡p láº¡i, nÃ³i chung lÃ  cho phÃ©p read vÃ  write access luÃ´n.

Náº¿u Ä‘Ãºng nhÆ° váº­y thÃ¬ tá»‘t quÃ¡. **NhÆ°ng cÃ³ má»™t váº¥n Ä‘á»**. BIOS cá»§a chÃºng ta bá»‹ áº©n khÃ¡ nhiá»u thá»© vÃ  sáº½ cháº¯c cháº¯n khÃ´ng cÃ³ nhá»¯ng tÃ¹y chá»n nÃ y. Váº­y chÃºng ta chá»‰nh kiá»ƒu gÃ¬? Tháº­t may máº¯n cho chÃºng ta, mÃ¬nh lÆ°á»›t GitHub má»™t há»“i vÃ  tÃ¬m tháº¥y cÃ¢u tráº£ lá»i: [**setup.var.efi**](https://github.com/datasone/setup_var.efi)! ÄÃ¢y lÃ  má»™t á»©ng dá»¥ng Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ cháº¡y trong UEFI Shell, giÃºp thay Ä‘á»•i cÃ¡c tÃ¹y chá»n áº©n trong UEFI thÃ´ng qua viá»‡c **Ä‘iá»n offset**.

Äáº§u tiÃªn, ta táº£i [**UEFI Shell**](https://github.com/pbatard/UEFI-Shell/releases) (`shellx64.efi`), copy vÃ o má»™t USB Ä‘Æ°á»£c format FAT32 theo Ä‘Æ°á»ng dáº«n `EFI\BOOT\BOOTX64.EFI`. Tiáº¿p theo, ta táº£i binary cá»§a `setup_var.efi` vá» Ä‘Æ°á»ng dáº«n chÃ­nh cá»§a USB. Boot mÃ¡y vÃ o USB báº¡n vá»«a táº¡o (nhá»› táº¯t Secure Boot nhÃ©!), ta sáº½ nháº­n Ä‘Æ°á»£c mÃ n hÃ¬nh sau:

![image.jpg](/images/uefi_shell.jpg)

Náº¿u ta Ä‘á»c qua syntax cá»§a setup_var.efi trong cÃ¡i README.md cá»§a nÃ³, ta cÃ³ thá»ƒ tháº¥y Ä‘Æ°á»£c cÃ¡i syntax khÃ¡ Ä‘Æ¡n giáº£n. Äá»ƒ chá»‰nh `BIOS Lock` vÃ  `BIOS Interface Lock` thÃ nh `Disabled` vÃ  `Me Fw Image Re-Flash` thÃ nh `Enabled`, ta xÃ i cÃ¡c lá»‡nh sau:

```
setup_var.efi Setup:0x75=0x0
setup_var.efi Setup:0x77=0x0
setup_var.efi Setup:0x2BC=0x1
```

Giáº£i thÃ­ch sÆ¡ qua vá»›i vÃ­ dá»¥ `BIOS Lock` nhÃ©: Ta yÃªu cáº§u setup_var.efi vÃ o store `Setup` (`VarStore: 0x2`), cho giÃ¡ trá»‹ 0x0 (`Disabled`) vÃ o offset `0x75` (`BIOS Lock`). Äiá»u tÆ°Æ¡ng tá»± cÃ³ thá»ƒ Ä‘Æ°á»£c hiá»ƒu vá»›i 2 lá»‡nh cÃ²n láº¡i nha. Tiáº¿p tá»¥c vá»›i...

## Dump firmware gá»‘c cá»§a mÃ¡y (pháº§n 2)

Sau khi khá»Ÿi Ä‘á»™ng láº¡i mÃ¡y vÃ  cháº¡y láº¡i lá»‡nh `FPTW64.exe -I`, ta tháº¥y Ä‘Æ°á»£c ráº±ng Intel ME Ä‘Ã£ cÃ³ full read vÃ  write access ğŸ™Œ

![image.png](/images/flash_info_image_P2.png)

ChÃºng ta cÅ©ng Ä‘Ã£ cÃ³ thá»ƒ viáº¿t Ä‘Ã¨ láº¡i vÃ o phÃ¢n vÃ¹ng BIOS cÃ¡i file `bios.bin` mÃ  ta dump há»“i nÃ£y ná»¯a ğŸ‘€

![image.png](/images/write_bios_success.png)

VÃ  hÆ¡n cáº£, ta Ä‘Ã£ cÃ³ thá»ƒ **dump full content chip BIOS ra** mÃ  khÃ´ng gáº·p váº¥n Ä‘á» gÃ¬!

![image.png](/images/fullbios_dump_success.png)

Vá»›i cÃ¡i dump BIOS nÃ y, vá» sau náº¿u BIOS cá»§a cÃ¡c báº¡n cÃ³ bá»‹ corrupt hay gÃ¬ Ä‘i ná»¯a thÃ¬ cÃ¡c báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡i dump backup nÃ y Ä‘á»ƒ cá»©u mÃ¡y vá» tráº¡ng thÃ¡i ban Ä‘áº§u.

## Extract logo trong phÃ¢n vÃ¹ng BIOS
Cuá»‘i cÃ¹ng má»›i Ä‘áº¿n pháº§n thÃº vá»‹ cÃ¡c báº¡n áº¡...! Tiáº¿p tá»¥c má»Ÿ file `bios.bin` trong UEFITool.

ThÆ°á»ng trong BIOS, cÃ¡c nhÃ  sáº£n xuáº¥t sáº½ sá»­ dá»¥ng nhá»¯ng Ä‘á»‹nh dáº¡ng áº£nh nhÆ° BMP, JPG vÃ  PNG. Viá»‡c cá»§a chÃºng ta lÃ  tÃ¬m chÃ­nh xÃ¡c cÃ¡i boot logo cá»§a nhÃ  sáº£n xuáº¥t vÃ  thay thÃ´i. NhÆ°ng mÃ , khi nhÃ¬n qua Ä‘á»‘ng nÃ y thÃ¬... nhÃ¬n **hÆ¡i loáº¡n nhá»‰!?**

![image.png](/images/uefitool_mess.png)\
<sup>má»‹e, nhÃ¬n tháº¿ nÃ y thÃ¬ biáº¿t tÃ¬m Ä‘i Ä‘Ã¢u!?</sup>

Thá»±c ra viá»‡c tÃ¬m áº£nh nÃ³ khÃ´ng khÃ³ láº¯m, náº¿u cÃ¡c báº¡n Ä‘á»™ng nÃ£o Ä‘Ã´i chÃºt. Báº±ng cÃ¡ch sá»­ dá»¥ng Hex pattern Search cá»§a UEFITool, cÃ¡c báº¡n cÃ³ thá»ƒ tÃ¬m áº£nh trong vÃ²ng nhÃ¡y máº¯t.

![image.png](/images/find_bmp_hex.png)

NhÆ° áº£nh trÃªn lÃ  mÃ¬nh Ä‘ang sá»­ dá»¥ng má»¥c Search, Ä‘á»ƒ lÃ  `Body only`, vÃ  Ä‘ang tÃ¬m hex `42 4D` - **lÃ  mÃ£ hex khá»Ÿi Ä‘áº§u cá»§a má»i áº£nh bitmap**. TrÃªn thanh output search, UEFITool Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c ráº¥t nhiá»u má»¥c, nhÆ°ng báº¡n chá»‰ nÃªn chÃº Ã½ tá»›i nhá»¯ng má»¥c hiá»‡n `Raw section`, vÃ¬ nÃ³ khÃ´ng pháº£i lÃ  má»™t binary hay image liÃªn quan Ä‘áº¿n UEFI mÃ  tool nháº­n dáº¡ng Ä‘Æ°á»£c, mÃ  lÃ  1 file hoÃ n toÃ n khÃ¡c.

![image.png](/images/found_boot_logo.png)

VÃ  sau Ä‘Ã³, mÃ¬nh thá»­ áº¥n `Extract body` cá»§a cÃ¡i má»¥c Ä‘Ã³, lÆ°u file dÆ°á»›i Ä‘uÃ´i `.bmp` thá»­ vÃ  voila! MÃ¬nh Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c thÃ nh cÃ´ng boot logo cá»§a firmware. Cho báº¡n nÃ o muá»‘n biáº¿t thÃ¬ con Dell nÃ y cá»§a mÃ¬nh cÃ³ boot logo á»Ÿ trong má»¥c cÃ³ GUID lÃ  `EB3001D5-F827-4938-95E2-5C8F644B966F`, search báº±ng GUID lÃ  tháº¥y.

CÃ¡c báº¡n cÃ³ thá»ƒ lÃ m Ä‘iá»u tÆ°Æ¡ng tá»± vá»›i cÃ¡c Ä‘á»‹nh dáº¡ng áº£nh khÃ¡c, vÃ­ dá»¥ nhÆ° JPG vá»›i header `FF D8 FF`, hoáº·c PNG vá»›i header `89 50 4E 47 0D 0A 1A 0A`.

## Chá»‰nh sá»­a áº£nh Ä‘Ã£ extract vÃ  thay tháº¿ vá»›i áº£nh cÅ©
Khi extract áº£nh vÃ  xem qua, ta tháº¥y Ä‘Æ°á»£c tÃ­nh tráº¡ng cá»§a file nhÆ° sau: **1280x1280 vá»›i 4-bit mÃ u**.

![image.png](/images/image_properties.png)

Khi chÃºng ta edit, chÃºng ta cáº§n cháº¯c cháº¯n ráº±ng thuá»™c tÃ­nh cá»§a áº£nh má»›i vá» kÃ­ch cá»¡ vÃ  bit mÃ u sáº½ **giá»‘ng vá»›i áº£nh cÅ©**. Äáº·c biá»‡t vá»›i nhá»¯ng format nhÆ° JPG vÃ  PNG, áº£nh má»›i cá»‘ gáº¯ng khÃ´ng Ä‘Æ°á»£c quÃ¡ náº·ng so vá»›i áº£nh cÅ© Ä‘á»ƒ BIOS cÃ²n chá»— chá»©a lÆ°u.

CÃ¡ch edit ráº¥t Ä‘Æ¡n giáº£n thÃ´i, má»Ÿ pháº§n má»m chá»‰nh áº£nh báº¡n thÃ­ch, sá»­a áº£nh vÃ  khi lÆ°u áº£nh, kÃ­ch cá»¡ vÃ  bit mÃ u pháº£i giá»‘ng áº£nh cÅ©.

![image.png](/images/new_logo_show.png)

Sau khi Ä‘Ã£ sá»­a xong áº£nh, báº¡n cáº§n [**UEFITool 0.28.0**](https://github.com/LongSoft/UEFITool/releases/tag/0.28.0) Ä‘á»ƒ cÃ³ thá»ƒ chá»‰nh sá»­a file BIOS. LÃ­ do lÃ  nhá»¯ng báº£n UEFITool xÃ i engine má»›i (UEFITool NE) chÆ°a há»— trá»£ image editing.

Má»Ÿ UEFITool 0.28.0 lÃªn, tÃ¬m láº¡i entry chá»©a file BIOS nhÆ° cÃ¡ch Ä‘Ã£ tÃ¬m khi á»Ÿ UEFITool báº£n má»›i. Khi Ä‘Ã£ tÃ¬m tháº¥y, áº¥n chuá»™t pháº£i rá»“i `Replace body` vÃ  chá»n file áº£nh báº¡n Ä‘Ã£ sá»­a. Khi nÃ o nÃ³ hiá»‡n `Remove` vá»›i `Replace` lÃ  oke.

![image.png](/images/replace_body_context.png)
![image.png](/images/rebuild_remove.png)

CÆ¡ mÃ  Ä‘á»£i Ä‘Ã£... **CHá»š LÆ¯U IMAGE VÃ€ THOÃT!** CÃ²n nhá»› lÃºc Ä‘áº§u mÃ¬nh báº£o ráº±ng, mÃ¡y cá»§a chÃºng ta **cÃ³ Intel Boot Guard** khÃ´ng? Äá»ƒ mÃ¬nh giáº£i thÃ­ch:

![image.png](/images/uefitool_comparison.png)

ÄÃ¢y lÃ  hai cá»­a sá»• UEFITool, bÃªn trÃ¡i lÃ  file firmware cá»§a chÃºng ta trong UEFITool 0.28.0 sau khi mod, bÃªn pháº£i lÃ  UEFITool New Engine. Náº¿u cÃ¡c báº¡n cÃ²n nhá»›, thÃ¬ nhá»¯ng pháº§n tÃ´ mÃ u á»Ÿ bÃªn UEFITool NE **chá»‰ nhá»¯ng pháº§n Ä‘Æ°á»£c Intel Boot Guard** báº£o vá»‡.

Khi UEFITool 0.28.0 modify má»™t volume, báº±ng má»™t cÃ¡ch ma quá»· nÃ o Ä‘Ã³, Ä‘Ã´i lÃºc nÃ³ cÅ©ng sáº½ tÃ¬nh cá» modify má»™t volume khÃ¡c luÃ´n. Nhá»¯ng volume nÃ o bá»‹ modify thÃ¬ cÃ¡c báº¡n sáº½ tháº¥y hiá»‡n `Rebuild` á»Ÿ cá»™t Action.

![image.png](/images/rebuild_indicator_uefitool.png)

VÃ  hay chÆ°a...! UEFITool 0.28.0 Ä‘ang cÃ³ Ã½ Ä‘á»‹nh modify volume cuá»‘i cÃ¹ng trong cÃ¡i UEFI image, náº¿u báº¡n tham chiáº¿u qua bÃªn cá»­a sá»• UEFITool NE bÃªn cáº¡nh thÃ¬ cÃ¡c báº¡n cÅ©ng cÃ³ thá»ƒ tháº¥y ráº±ng **volume Ä‘Ã³ Ä‘ang Ä‘Æ°á»£c báº£o vá»‡ bá»Ÿi Boot Guard (mÃ u Ä‘á» á»Ÿ dÆ°á»›i cÃ¹ng)!** CÃ³ nghÄ©a lÃ  náº¿u cÃ¡c báº¡n save file á»Ÿ tráº¡ng thÃ¡i nÃ y vÃ  Ä‘em flash vÃ o mÃ¡y luÃ´n, **mÃ¡y cá»§a cÃ¡c báº¡n sáº½ brick NGAY Láº¬P Tá»¨C.**

![image.png](/images/bootguard_comparison.png)

Äá»ƒ cÃ³ thá»ƒ mod thÃ nh cÃ´ng, cÃ¡c báº¡n áº¥n chuá»™t pháº£i vÃ o nhá»¯ng pháº§n nÃ o liÃªn quan Ä‘áº¿n Boot Guard á»Ÿ bÃªn UEFITool 0.28.0 vÃ  áº¥n `Do not rebuild`, lÃºc nÃ y dÃ²ng chá»¯ sáº½ chuyá»ƒn tá»« `Rebuild` thÃ nh `Do not rebuild`, vÃ  lÃºc lÆ°u thÃ¬ UEFITool 0.28.0 sáº½ khÃ´ng Ä‘áº£ Ä‘á»™ng gÃ¬ vÃ o pháº§n Ä‘Ã³ ná»¯a.

![image.png](/images/do_not_rebuild.png)

## Flash vÃ ... táº­n hÆ°á»Ÿng!
Sau khi kiá»ƒm tra má»i thá»© xong xuÃ´i, cÃ¡c báº¡n save file láº¡i dÆ°á»›i 1 file tÃªn khÃ¡c, nhÆ° trÆ°á»ng há»£p cá»§a mÃ¬nh sáº½ Ä‘á»ƒ lÃ  `newbios.bin`, vÃ  nÃ©m qua flash báº±ng `FPTW64.exe -bios -F newbios.bin` thÃ´i!

![image.png](/images/modded_flash_success.png)

Sau khi flash xong, cÃ¡c báº¡n **táº¯t háº³n mÃ¡y** (Ä‘á»«ng reboot) vÃ  báº­t láº¡i lÃªn Ä‘á»ƒ chip BIOS má»›i sá»­ dá»¥ng láº¡i content má»›i mÃ  vá»«a Ä‘Æ°á»£c flash vÃ o. VÃ ... logo boot má»›i say hi!

![image.jpg](/images/result.jpg)

## Notes
- Blog nÃ y Ä‘Æ°á»£c lÃ m Ä‘á»ƒ miÃªu táº£ quÃ¡ trÃ¬nh mod trÃªn má»™t chiáº¿c Dell Latitude E7240, nhÆ°ng mÃ¬nh cÅ©ng Ä‘Ã£ mod thÃ nh cÃ´ng 1 chiáº¿c Dell Vostro 15 3568 qua call online vá»›i tháº±ng báº¡n [Nico](https://www.facebook.com/silly1nico). [Proof á»Ÿ Ä‘Ã¢y ğŸ¤“](/images/proof_nico.jpg)
- Äá»ƒ tÃ¬m hiá»ƒu thÃªm vá» cÃ¡c loáº¡i protection cá»§a chip SPI trong mÃ¡y, báº¡n cÃ³ thá»ƒ check qua [**bÃ i blog nÃ y cá»§a eclypsium**](https://eclypsium.com/blog/firmware-security-realizations-part-3-spi-write-protections/) hoáº·c [**thread nÃ y trÃªn Win-Raid**](https://winraid.level1techs.com/t/guide-unlock-intel-flash-descriptor-read-write-access-permissions-for-spi-servicing/32449).
- Náº¿u báº¡n muá»‘n, báº¡n cÅ©ng cÃ³ thá»ƒ dump vÃ  flash BIOS qua Afuwin hoáº·c cÃ¡c cÃ¡ch khÃ¡c náº¿u thÃ­ch, dÃ¹ mÃ¬nh chÆ°a thá»­ (vÃ  mÃ¬nh cÅ©ng cÃ³ cáº£m giÃ¡c lÃ  cÃ¡i Intel ME nÃ³ an toÃ n hÆ¡n ğŸ¥²)
- Post nÃ y náº¿u Ä‘Æ°á»£c Ã¡p dá»¥ng linh hoáº¡t thÃ¬ cÃ³ thá»ƒ Ã¡p dá»¥ng trÃªn cÃ¡c mÃ¡y model khÃ¡c, tháº­m chÃ­ lÃ  hÃ£ng khÃ¡c luÃ´n. Äáº·c biá»‡t lÃ  lÅ© PC, táº¡i consumer PC thÃ¬ hiáº¿m cÃ³ mainboard trang bá»‹ Intel Boot Guard, trá»« nhá»¯ng dÃ²ng high-end hoáº·c vÃ i series pre-built cá»§a máº¥y hÃ£ng lá»›n.

**Alright byee, háº¹n gáº·p láº¡i cÃ¡c báº¡n á»Ÿ má»™t post khÃ¡c â­ï¸**

